<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            http-equiv="Content-Security-Policy"
            content="default-src 'none'; img-src 'self'; script-src 'none'; style-src 'self'; object-src 'none'; font-src 'none'; form-action 'self'; frame-src 'none'; media-src 'none'; manifest-src 'none'; worker-src 'none';"
        />
        <title>äººäººå½±è§†å­—å¹•</title>
        <link rel="stylesheet" href="/style.css" />
    </head>
    <body>
        <header class="search-header">
            <nav class="search-nav">
                <form id="search" action="/" method="get">
                    <div class="searchbar search-searchbar">
                        <input
                            class="search-input"
                            type="text"
                            id="search"
                            name="search"
                            value="{{ search }}"
                        />
                        <button type="submit" class="search-button">ğŸ”</button>
                    </div>
                </form>
            </nav>
            <nav class="search-second-nav">
                <div>
                    <p>
                        æ‰¾åˆ° {{ total }}
                    </p>
                </div>
            </nav>
        </header>

        <main class="search-results">
            {% for subtitle in subtitles %}
            <article class="subtitle-card">
                <div class="subtitle-header">
                    <div class="subtitle-title">
                        <h2 class="subtitle-cnname">{{ subtitle.cnname }}</h2>
                        {% match subtitle.enname %}
                        {% when Some with (name) %}
                        <p class="subtitle-enname">{{ name }}</p>
                        {% when None %}
                        {% endmatch %}
                        {% match subtitle.segment %}
                        {% when Some with (seg) %}
                        <p class="subtitle-segment">ğŸ“º {{ seg }}</p>
                        {% when None %}
                        {% endmatch %}
                    </div>
                    {% match subtitle.file %}
                    {% when Some with (url) %}
                    <a href="/static/{{ url }}" class="download-btn">
                        <span>â¬‡</span>
                        <span>ä¸‹è½½</span>
                    </a>
                    {% when None %}
                    {% endmatch %}
                </div>
                
                <div class="subtitle-tags">
                    {% if subtitle.lang.len() > 0 %}
                    <span class="tag tag-lang">{{ subtitle.lang }}</span>
                    {% endif %}
                    {% if subtitle.format.len() > 0 %}
                    <span class="tag tag-format">{{ subtitle.format }}</span>
                    {% endif %}
                    <span class="tag tag-source">
                        {% if subtitle.source == "original" %}åŸåˆ›
                        {% elif subtitle.source == "trans" %}è½¬è½½
                        {% elif subtitle.source == "official" %}å®˜æ–¹
                        {% else %}{{ subtitle.source }}
                        {% endif %}
                    </span>
                </div>
                
                <div class="subtitle-stats">
                    <div class="stat">
                        <span class="stat-icon">ğŸ‘ï¸</span>
                        <span class="stat-value">{{ subtitle.views }}</span>
                    </div>
                    <div class="stat">
                        <span class="stat-icon">â¬‡</span>
                        <span class="stat-value">{{ subtitle.downloads }}</span>
                    </div>
                </div>
            </article>
            {% endfor %}
            
            {% if subtitles.len() == 0 %}
            <div class="empty-state">
                <div class="empty-state-icon">ğŸ¬</div>
                <p class="empty-state-text">æ²¡æœ‰æ‰¾åˆ°å­—å¹•ï¼Œè¯•è¯•å…¶ä»–å…³é”®è¯å§</p>
            </div>
            {% endif %}
        </main>
    </body>
</html>

